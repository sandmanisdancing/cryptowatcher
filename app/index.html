<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <title>Your Crypto investments watcher</title>

  <!-- <link rel="canonical" href="https://atlas.kyivstar.ua"> -->
  <link rel="manifest" href="manifest.json">

  <!-- PWA icons, uncomment for production -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Your Crypto investments watcher">
  <link rel="apple-touch-icon" href="images/icons/icon-152x152.png">

  <meta name="msapplication-TileImage" content="images/icons/icon-144x144.png">
  <meta name="msapplication-TileColor" content="#229fff">

  <!-- shortcut icon, uncomment for production -->
  <link rel="shortcut icon" href="images/icons/icon-32x32.png" type="image/ico">

  <!-- preload and prefetch, uncomment for production -->
  <!-- <link rel="dns-prefetch" href="//cdn.kyivstar.ua"> -->
  <!-- <link rel="preload" href="fonts/museo300.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="preload" href="fonts/museo700.woff2" as="font" type="font/woff2" crossorigin=""> -->


  <link rel="stylesheet" type="text/css" href="styles/main.css" media="all">
  <link rel="stylesheet" type="text/css" href="styles/desktop.css" media="(min-width: 700px)">
  <link rel="preload" href="scripts/main.js" as="script">
</head>
<body>
  <div id="crypto-app" v-cloak>
    <header class="pageheader">
      <h1 class="pageheader__name">My crypto portfolio</h1>

      <div class="load-status" v-if="loadStatus">{{ loadStatus }}</div>
      <button class="btn btn--blue" @click="openWindow">Add investment</button>
      <button class="btn btn--yellow" @click="fetchData">Refresh data</button>
    </header>

    <main role="main">
      <section class="portfolio">
        <table id="my-investments" class="table">
          <tr>
            <th>Actions</th>
            <th>Token symbol</th>
            <th>Invested, crypto</th>
            <th>Invested, USD</th>
            <th>Stay, USD</th>
            <th>Amount</th>
            <th>Withdraw, USD</th>
            <th>Withdraw, tkns</th>
            <th>Now, USD</th>
            <th>Withdraw + Now</th>
            <th>ICO Finish</th>
          </tr>
          <tr v-for="(investment, index) in myInvestments" :key="investment.id">
            <td>
              <button type="button" @click="removeToken(index)" title="Delete">X</button>
              <button type="button" @click="editToken(index)" title="Edit">E</button>
            </td>
            <td>{{ investment.coinsSymbol }}</td>
            <td>{{ investment.cryptoInvestedAmount }} {{ investment.cryptoInvestedSymbol }}</td>
            <td>{{ investment.usdInvested }}</td>
            <td>{{ countRate(investment.cryptoInvestedAmount, investment.cryptoInvestedSymbol) }}</td>
            <td>{{ investment.coinsAmount }}</td>
            <td>{{ investment.usdWithdraw }}</td>
            <td>{{ investment.tokensWithdraw }}</td>
            <td>{{ countRate(investment.coinsAmount, investment.coinsSymbol) }}</td>
            <td>{{ +investment.usdWithdraw + +countRate(investment.coinsAmount, investment.coinsSymbol) }}</td>
            <td><nobr>{{ investment.finishDate }}</nobr><br>{{ investment.finishDate | dateToDays }}</td>
          </tr>
        </table>

        <table id="currencyRate" class="table">
          <tr>
            <th colspan="2">Current rate</th>
          </tr>
          <tr>
            <th>Pair</th>
            <th>Price, USD</th>
          </tr>
          <tr v-for="rate in myInvestments">
            <td>{{ rate.coinsSymbol }}/USD</td>
            <td>{{ countRate(1, rate.coinsSymbol) }}</td>
          </tr>
        </table>

        <table id="top10" class="table" v-if="top10ready">
          <tr v-for="(key, value) in top10list">
            <td>{{ value }}</td>
            <td>{{ key }}</td>
          </tr>
        </table>
      </section>
    </main>

    <footer class="pagefooter">
      &copy; 2017 — you are able to use this app in the way you need it.
    </footer>

    <!-- POPUP -->

    <div class="popup-overlay" v-if="investPopup" @click="closeWindow" v-on:keydown.esc="closeWindow" tabindex="0">
      <section class="popup">
        <button type="button" class="popup__close" aria-label="Close" @click="closeWindow"></button>

        <div class="popup__inner">
          <article class="invest">
            <form action="#">
              <div class="invest__screen">
                <h3>Invested</h3>
                <div class="invest__columns">
                  <div class="invest__block">
                    <label for="crypto-spent" class="invest__label">Crypto amount</label>
                    <div class="invest__line">
                      <input type="number" v-model="investTemplate.cryptoInvestedAmount" id="crypto-spent" class="input-field" placeholder="0.361" min="0" step="0.1">
                      <select class="input-field" v-model="investTemplate.cryptoInvestedSymbol">
                        <option value="Crypto name" disabled>Crypto name</option>
                        <option v-for="currency in currenciesList" :value="currency.symbol">{{ currency.name }}</option>
                      </select>
                    </div>
                  </div>
                  <div class="invest__block">
                    <label for="usd-spent" class="invest__label">Invested in USD</label>
                    <div class="invest__line">
                      <input type="number" v-model="investTemplate.usdInvested" id="usd-spent" class="input-field" :placeholder="0.361 * top10list.Bitcoin" min="0" >
                    </div>
                  </div>
                </div>
              </div>

              <div class="invest__screen">
                <h3>Got</h3>
                <div class="invest__columns">
                  <div class="invest__block">
                    <label for="coins-amount" class="invest__label">Coins / tokens amount</label>
                    <div class="invest__line">
                      <input type="number" v-model="investTemplate.coinsAmount" id="coins-amount" class="input-field" placeholder="983.4458" min="0">
                    </div>
                  </div>
                  <div class="invest__block">
                    <label for="coins-symbol" class="invest__label">Symbol for coins / tokens<span class="secondary-span">, i.e. BNT for Bancor</span></label>
                    <div class="invest__line">
                      <input type="text" v-model="investTemplate.coinsSymbol" id="coins-symbol" class="input-field" placeholder="BNT" required>
                    </div>
                  </div>
                </div>
                <div class="invest__block">
                  <h3><label for="finish-date" class="invest__label">Finish date</label></h3>
                  <div class="invest__line">
                    <input lang="en" type="date" v-model="investTemplate.finishDate" id="finish-date" class="input-field">
                  </div>
                </div>
                <p>If you don’t know all info for now, it's ok, you can always edit this information.</p>
              </div>

              <p class="invest__done">
                <button type="button" class="btn btn--yellow" @click="createInvestment">Done!</button>
              </p>
            </form>
          </article>
        </div>
      </section>
    </div>
  </div>
  <script src="scripts/main.js" defer></script>
</body>
</html>
